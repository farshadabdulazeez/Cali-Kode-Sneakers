{% extends 'base.html' %}
{% block title %}
User-Profile
{% endblock title %}
{% load static %}

{% block content %}

    <div class="main-wrapper">
        <div class="breadcrumb-area bg-gray">
            <div class="container">
                <div class="breadcrumb-content text-center">
                    <ul>
                        <li>
                            <a href="{% url 'index' %}">Home</a>
                        </li>
                        <li class="active">My account </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- my account wrapper start -->
        <div class="my-account-wrapper pt-120 pb-120">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <!-- My Account Page Start -->
                        <div class="myaccount-page-wrapper">
                            <!-- My Account Tab Menu Start -->
                            <div class="row">
                                <div class="col-lg-3 col-md-4">
                                    <div class="myaccount-tab-menu nav" role="tablist">
                                        <a href="#dashboad" class="active" data-toggle="tab"><i class="fa fa-dashboard"></i>
                                            Dashboard</a>
                                        <a href="#orders" data-toggle="tab"><i class="fa fa-cart-arrow-down"></i> Orders</a>
                                        <a href="#download" data-toggle="tab"><i class="fa fa-cloud-download"></i> Download</a>
                                        <a href="#address-edit" data-toggle="tab"><i class="fa fa-map-marker"></i> Address</a>
                                        <a href="#account-info" data-toggle="tab"><i class="fa fa-user"></i> Account Details & Change Password</a>
                                        <a href="#change-password" data-toggle="tab"><i class="fa fa-key"></i> Change Password</a>
                                        <a href="{% url 'user_logout' %}"><i class="fa fa-sign-out"></i> Logout</a>
                                    </div>
                                </div>
                                <!-- My Account Tab Menu End -->
                                <!-- My Account Tab Content Start -->
                                <div class="col-lg-9 col-md-8">
                                    <div class="tab-content" id="myaccountContent">
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade show active" id="dashboad" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Dashboard</h3>
                                                <div class="welcome">
                                                    <p>Hello, <strong>Alex Tuntuni</strong> (If Not <strong>Tuntuni !</strong><a href="login-register.html" class="logout"> Logout</a>)</p>
                                                </div>

                                                <p class="mb-0">From your account dashboard. you can easily check & view your recent orders, manage your shipping and billing addresses and edit your password and account details.</p>
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="orders" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Orders</h3>
                                                <div class="myaccount-table table-responsive text-center">
                                                    <table class="table table-bordered">
                                                        <thead class="thead-light">
                                                            <tr>
                                                                <th>Order no.</th>
                                                                <th>Product</th>
                                                                <th>Quantity</th>
                                                                <th>Size</th>
                                                                <th>Status</th>
                                                                <th>Details</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for order in order_product %}
                                                            <tr>
                                                                <td>{{ order.order_id.order_id }}</td>
                                                                <td>{{ order.variant.product.product_name }}</td>
                                                                <td>{{ order.quantity }}</td>
                                                                <td>{{ order.variant.product_size.size }}</td>
                                                                <td>{{ order.order_id.status }}</td>
                                                                <td><a href="{% url 'order_details' order.order_id.id %}" class="check-btn sqr-btn ">View</a></td>
                                                            </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="download" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Downloads</h3>
                                                <div class="myaccount-table table-responsive text-center">
                                                    <table class="table table-bordered">
                                                        <thead class="thead-light">
                                                            <tr>
                                                                <th>Product</th>
                                                                <th>Date</th>
                                                                <th>Expire</th>
                                                                <th>Download</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Haven - Free Real Estate PSD Template</td>
                                                                <td>Aug 22, 2018</td>
                                                                <td>Yes</td>
                                                                <td><a href="#" class="check-btn sqr-btn "><i class="fa fa-cloud-download"></i> Download File</a></td>
                                                            </tr>
                                                            <tr>
                                                                <td>HasTech - Profolio Business Template</td>
                                                                <td>Sep 12, 2018</td>
                                                                <td>Never</td>
                                                                <td><a href="#" class="check-btn sqr-btn "><i class="fa fa-cloud-download"></i> Download File</a></td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        

                                        <div class="tab-pane fade" id="address-edit" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Billing Address</h3>
                                        
                                                {% if address %}
                                                {% for i in address %}

                                                <div class="card mb-3">
                                                    <div class="card-body">
                                                        <p><strong>{{forloop.counter}}. {{ i.name }}</strong></p>
                                                        <p>Address : {{ i.address }} , {{ i.landmark }} , {{ i.city }} , POST.{{ i.pincode }} , {{ i.district }} , {{ i.state }}</p>
                                                        <p>Mobile : {{ i.mobile }}</p>

                                                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lrg-{{ i.id }}" style="border-radius: 0; border: none;">Edit address</button>
                                                        <a href="{% url 'delete_address' i.id %}" class="btn btn-danger" style="border-radius: 0; border: none;">Delete address</a>
                                                    </div>
                                                </div>
                                                
                                                {% endfor %}
                                                {% endif %}

                                                <div class="text-center">
                                                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg" style="border-radius: 0; border: none;">Add address</button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="account-info" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Account Details</h3>
                                                <div class="account-details-form">
                                                    <form action="" method="POST">
                                                        {% csrf_token %}
                                                        <div class="row">
                                                            <div class="col-lg-6">
                                                                <div class="single-input-item">
                                                                    <label for="first-name" class="required">First Name</label>
                                                                    <input type="text" id="first-name"  value="{{ user.first_name }}"
                                                                    name="first_name"/>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-6">
                                                                <div class="single-input-item">
                                                                    <label for="last-name" class="required">Last Name</label>
                                                                    <input type="text" id="last-name"  value="{{ user.last_name }}"
                                                                    name="last_name"/>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="single-input-item">
                                                            <label for="email" class="required">Email Address</label>
                                                            <input type="email" id="email" value="{{ user.email }}" name="email" />
                                                        </div>

                                                        <div class="single-input-item">
                                                            <label for="display-name" class="required">Mobile Number</label>
                                                            <input type="text" id="display-name"  value="{{ user.mobile }}"
                                                            name="mobile" />
                                                        </div>

                                                        <div class="single-input-item">
                                                            <label for="display-name" class="required">D.O.B</label>
                                                            <input type="text" id="display-name"  value="{{ user.date_of_birth }}"
                                                            name="date_of_birth" />
                                                        </div>
                                                        
                                                        <div class="single-input-item">
                                                            <button type="submit" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lgt">Edit account</button>                                       

                                                        </div>
                                                        <br>
                                                    </form>
                                                    {% comment %} <form action="" method="POST">
                                                        {% csrf_token %}
                                                        
                                                        {% for error in form.non_field_errors %}
                                                            <div class="alert alert-danger">
                                                                {{ error }}
                                                            </div>
                                                        {% endfor %}
                                                        
                                                        {% for field in form %}
                                                            <div class="form-group">
                                                                <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                                                                {{ field }}
                                                            </div>
                                                            {% if field.errors %}
                                                                <div class="alert alert-danger">
                                                                    {{ field.errors }}
                                                                </div>
                                                            {% endif %}
                                                        {% endfor %}
                                                        
                                                        <button type="submit" class="btn btn-primary " data-toggle="modal" data-target=".bd-example-modal-lgt">
                                                            Change Password
                                                        </button>
                                                    </form> {% endcomment %}
                                                    
                                                </div>
                                            </div>
                                        </div> <!-- Single Tab Content End -->

                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="change-password" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Change Password</h3>
                                                <form action="{% url 'change_password' %}" method="POST">
                                                    {% csrf_token %}
                                                    
                                                    {% for error in form.non_field_errors %}
                                                        <div class="alert alert-danger">
                                                            {{ error }}
                                                        </div>
                                                    {% endfor %}
                                                    
                                                    {% for field in form %}
                                                        <div class="form-group">
                                                            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                                                            {{ field }}
                                                        </div>
                                                        {% if field.errors %}
                                                            <div class="alert alert-danger">
                                                                {{ field.errors }}
                                                            </div>
                                                        {% endif %}
                                                    {% endfor %}
                                                    
                                                    <button type="submit" class="btn btn-primary " data-toggle="modal" data-target=".bd-example-modal-lgt">
                                                        Change Password
                                                    </button>
                                                </form>
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->

                                    </div>
                                </div> <!-- My Account Tab Content End -->
                            </div>
                        </div> <!-- My Account Page End -->
                    </div>
                </div>
            </div>
        </div>


        <!-- add address modal -->

        <div class="modal fade bd-example-modal-lg container" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">               
                    <div class="container">
                    <form action="{% url 'add_address' user.id %}" method="post">
                        {% csrf_token %}

                        <div class="single-input-item">
                            <label for="first-name" class="required">Name</label>
                            <input type="text" id="first-name" name="name" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="mobile" class="required">Mobile Number</label>
                            <input type="text" id="mobile" name="mobile" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="address" class="required">Address</label>
                            <input type="text" id="address" name="address" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="landmark" class="required">Landmark</label>
                            <input type="text" id="landmark" name="landmark" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="city" class="required">City</label>
                            <input type="text" id="city" name="city" required />
                        </div>

                        <div class="single-input-item">
                            <label for="pincode" class="required">Pincode</label>
                            <input type="text" id="pincode" name="pincode" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="district" class="required">District</label>
                            <select class="form-control" id="district" name="district" required>
                                <option value=""><b>Select District*</b></option>
                                <option value="KASARAKODE">KASARAKODE</option>
                                <option value="KANNUR">KANNUR</option>
                                <option value="WAYANAD">WAYANAD</option>
                                <option value="KOZHIKODE">KOZHIKODE</option>
                                <option value="MALAPPURAM">MALAPPURAM</option>
                                <option value="PALAKKAD">PALAKKAD</option>
                                <option value="THRISSUR">THRISSUR</option>
                                <option value="ERNAKULAM">ERNAKULAM</option>
                                <option value="IDUKKI">IDUKKI</option>
                                <option value="KOTTAYAM">KOTTAYAM</option>
                                <option value="ALAPPUZHA">ALAPPUZHA</option>
                                <option value="PATHANAMTHITTA">PATHANAMTHITTA</option>
                                <option value="KOLLAM">KOLLAM</option>
                                <option value="THIRUVANANTHAPURAM">THIRUVANANTHAPURAM</option>
                            </select>
                        </div>

                        <div class="single-input-item">
                            <label for="state" class="required">State</label>
                            <input type="text" id="state" name="state" required/>

                        </div>
                        
                        <div class="single-input-item text text-center">
                            <button type="submit" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg">Add address</button>                                       
                        </div>
                    </form>
                </div>
                </div>
            </div>
        </div>

        <!-- edit address modal -->
        {% if address %}
        {% for i in address%}
        <div class="modal fade bd-example-modal-lrg-{{ i.id }} container" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">               
                    <div class="container">
                    <form action="{% url 'edit_address' i.id %}" method="post">
                        {% csrf_token %}
                        
                        <div class="single-input-item">
                            <label for="first-name" class="required">Name</label>
                            <input type="text" id="first-name" value="{{i.name}}" name="name" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="mobile" class="required">Mobile Number</label>
                            <input type="text" id="mobile" value="{{i.mobile}}" name="mobile" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="address" class="required">Address</label>
                            <input type="text" id="address" value="{{i.address}}" name="address" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="landmark" class="required">Landmark</label>
                            <input type="text" id="landmark" value="{{i.landmark}}" name="landmark" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="city" class="required">City</label>
                            <input type="text" id="city" value="{{i.city}}" name="city" required />
                        </div>

                        <div class="single-input-item">
                            <label for="pincode" class="required">Pincode</label>
                            <input type="text" id="pincode" value="{{i.pincode}}" name="pincode" required/>
                        </div>

                        <div class="single-input-item">
                            <label for="district" class="required">District</label>
                            <select class="form-control" id="district"  name="district" required>
                                <option value=""><b>Select District*</b></option>
                                <option value="KASARAKODE" {% if i.district == "KASARAKODE" %}selected{% endif %}>KASARAKODE</option>
                                <option value="KANNUR" {% if i.district == "KANNUR" %}selected{% endif %}>KANNUR</option>
                                <option value="WAYANAD" {% if i.district == "WAYANAD" %}selected{% endif %}>WAYANAD</option>
                                <option value="KOZHIKODE" {% if i.district == "KOZHIKODE" %}selected{% endif %}>KOZHIKODE</option>
                                <option value="MALAPPURAM" {% if i.district == "MALAPPURAM" %}selected{% endif %}>MALAPPURAM</option>
                                <option value="PALAKKAD" {% if i.district == "PALAKKAD" %}selected{% endif %}>PALAKKAD</option>
                                <option value="THRISSUR" {% if i.district == "THRISSUR" %}selected{% endif %}>THRISSUR</option>
                                <option value="ERNAKULAM" {% if i.district == "ERNAKULAM" %}selected{% endif %}>ERNAKULAM</option>
                                <option value="IDUKKI" {% if i.district == "IDUKKI" %}selected{% endif %}>IDUKKI</option>
                                <option value="KOTTAYAM" {% if i.district == "KOTTAYAM" %}selected{% endif %}>KOTTAYAM</option>
                                <option value="ALAPPUZHA" {% if i.district == "ALAPPUZHA" %}selected{% endif %}>ALAPPUZHA</option>
                                <option value="PATHANAMTHITTA" {% if i.district == "PATHANAMTHITTA" %}selected{% endif %}>PATHANAMTHITTA</option>
                                <option value="KOLLAM" {% if i.district == "KOLLAM" %}selected{% endif %}>KOLLAM</option>
                                <option value="THIRUVANANTHAPURAM" {% if i.district == "THIRUVANANTHAPURAM" %}selected{% endif %}>THIRUVANANTHAPURAM</option>
                            </select>
                        </div>

                        <div class="single-input-item">
                            <label for="state" class="required">State</label>
                            <input type="text" name="state" id="state" value="{{i.state}}" required>
                        </div>
                        
                        <div class="single-input-item">
                            <button type="submit" class="btn btn-primary" >Update address</button>                                       
                        </div>
                    </form>
                </div>
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}


        <!-- add account details -->

        <div class="modal fade bd-example-modal-lgt" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lgt">
                <div class="modal-content">
                ...
                </div>
            </div>
            </div>

{% endblock content %}
